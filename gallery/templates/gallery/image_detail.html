{% extends 'gallery/base.html' %}
{% load static %}

{% block content %}
<div class="image-detail">
    <h2>{{ image.title }}</h2>
    <img src="{{ image.image_file.url }}" alt="{{ image.title }}">
    <p>{{ image.description }}</p>

    <!-- Felt√∂lt≈ë megjelen√≠t√©se -->
    <p>Felt√∂lt√∂tte: 
        <a href="{% url 'profile' image.uploader.username %}">
            {{ image.uploader.username }}
        </a>
    </p>

    {% if image.tags.all %}
        <p>C√≠mk√©k:
            {% for tag in image.tags.all %}
                <span class="tag">{{ tag.name }}</span>
            {% endfor %}
        </p>
    {% else %}
        <p>Nincsenek c√≠mk√©k ehhez a k√©phez.</p>
    {% endif %}

    <!-- Like √©s Dislike gombok -->
    <div class="like-dislike-buttons">
        <form action="{% url 'like_image' image.id %}" method="post">
            {% csrf_token %}
            <button type="submit" class="like-btn">
                üëç Tetszik ({{ image.total_likes }})
            </button>
        </form>
        <form action="{% url 'dislike_image' image.id %}" method="post">
            {% csrf_token %}
            <button type="submit" class="dislike-btn">
                üëé Nem tetszik ({{ image.total_dislikes }})
            </button>
        </form>
    </div>

    <!-- Kommentek megjelen√≠t√©se -->
    <div class="comments-section">
        <h3>Hozz√°sz√≥l√°sok</h3>
        {% for comment in comments %}
            <div class="comment">
                <a href="{% url 'profile' comment.user.username %}">
                {% if comment.user.profile.profile_image %}
                    <img src="{{ comment.user.profile.profile_image.url }}" alt="{{ user.username }} profilk√©pe" class="profile-picture">
                {% else %}
                    <img src="{% static 'images/default_profile.png' %}" alt="Alap√©rtelmezett profilk√©p" class="profile-picture">
                {% endif %}
                <p><strong>{{ comment.user.username }}</strong> - {{ comment.created_at }}</p>
                </a>
            <p>{{ comment.content }}</p>
            </div>
        {% empty %}
            <p>Nincsenek hozz√°sz√≥l√°sok.</p>
        {% endfor %}
    </div>

    <!-- √öj hozz√°sz√≥l√°s ≈±rlapja -->
    {% if user.is_authenticated %}
        <h4>√öj hozz√°sz√≥l√°s</h4>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Hozz√°sz√≥l√°s bek√ºld√©se</button>
        </form>
    {% else %}
        <p>K√©rj√ºk, <a href="{% url 'login' %}">jelentkezz be</a>, hogy hozz√°sz√≥lhass.</p>
    {% endif %}


</div>
{% endblock %}
